# High-level information about the project.
project_name: "drune_example"
description: "Example project for processing customer and sales data."
version: "1.0.0"

# The active profile to use. Can be overridden by a CLI flag or environment variable.
# e.g., `drune run --profile prd` or `DRUNE_PROFILE=prd drune run`
profile: 'dev'

logging:
  path: "../scratch/logs/"
  level: "INFO"

# 5. Default Profile Output: Base settings for a profile's output.
# This section defines the default configuration that will be inherited by the
# active profile. The structure here directly mirrors the structure inside a
# profile's 'outputs' block.
defaults:
  engine:
    name: duckdb
    options:
      database: 'drune_default.db'
  
  # Default transformations applied based on data type.
  types:
    str:
      transform: upper|trim
    date:
      format: "yyyy-MM-dd"
  
  vars:
    test_name: "default"
    test_name_fixed: 'fixed'
  
  paths:
    pipelines: "pipelines/"
    sources: "data/"
    targets: "../scratch/targets/"

  # Default settings for data sources and targets (sinks).
  # These can be overridden in a specific profile or pipeline.
  sources:
    file:
      format: "csv"
      options:
        header: true
        inferSchema: false # It's safer to define schemas explicitly.
  
  targets:
    file:
      format: "parquet"
      mode: "overwrite"



# 6. Execution Profiles: Environment-specific configurations.
# A profile defines the target outputs and connections for a specific environment.
profiles:
  # The 'dev' profile for local development.
  dev: 
    engine:
      name: duckdb
      options:
        database: './drune_dev.db' # Path relative to project root.
    # In dev, we might want to output CSVs for easier inspection.
    # This overrides the 'parquet' default.
    targets:
      file:
        format: "csv"
    
    vars:
      test_name: "dev"
    

  # The 'prd' profile for the production environment.
  prd:
    engine:
      name: spark # Production might use a more scalable engine.
      options: {}
    # The 'prd' profile will inherit the default target format ('parquet')
    # because it is not overridden here.s