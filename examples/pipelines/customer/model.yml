engine: pandas
pipeline_name: customer_pipeline
description: Pipeline de exemplo para teste
dependencies: []

defaults:
  date_format: "yyyy-MM-dd"
  column_rename_pattern: snake_case

sources:
  customer_data:
    type: file
    format: csv
    path: "C:\\Users\\felipe.sampaio_visag\\Documents\\git\\drune\\examples\\data\\customer.csv"

sink:
  format: csv
  path: "dados/saida/teste.csv"
  mode: overwrite

columns:
  - name: customer_id
    rename: cd
    type: int
    pk: true
    validate:
      - rule: "isin:[101,102]"
        on_fail: "warn"
  - name: first_name
    type: str
  - name: last_name
    type: str
    optional: true
  - name: email
    type: str
    validate:
      - rule: "pattern:^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$"
        on_fail: "drop"
  - name: document
    rename: doc
    type: str


table_validations: []
foreign_keys: []

steps:
  - name: read_data
    type: read
  - name: transform_data
    type: transform
  - name: validate_data
    type: validate
  - name: write_data
    type: write
